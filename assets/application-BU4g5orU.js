import{q as Q,p as w,a as Z}from"./chunk-EPOLDU6W-CSYm8pw0.js";var U=1e-6,R=typeof Float32Array<"u"?Float32Array:Array,G=Math.random;function J(){var t=new R(9);return R!=Float32Array&&(t[1]=0,t[2]=0,t[3]=0,t[5]=0,t[6]=0,t[7]=0),t[0]=1,t[4]=1,t[8]=1,t}function M(){var t=new R(16);return R!=Float32Array&&(t[1]=0,t[2]=0,t[3]=0,t[4]=0,t[6]=0,t[7]=0,t[8]=0,t[9]=0,t[11]=0,t[12]=0,t[13]=0,t[14]=0),t[0]=1,t[5]=1,t[10]=1,t[15]=1,t}function tt(t){return t[0]=1,t[1]=0,t[2]=0,t[3]=0,t[4]=0,t[5]=1,t[6]=0,t[7]=0,t[8]=0,t[9]=0,t[10]=1,t[11]=0,t[12]=0,t[13]=0,t[14]=0,t[15]=1,t}function et(t,e,i){var r=e[0],n=e[1],s=e[2],a=e[3],o=e[4],l=e[5],f=e[6],h=e[7],g=e[8],x=e[9],c=e[10],P=e[11],m=e[12],y=e[13],u=e[14],d=e[15],v=i[0],p=i[1],b=i[2],C=i[3];return t[0]=v*r+p*o+b*g+C*m,t[1]=v*n+p*l+b*x+C*y,t[2]=v*s+p*f+b*c+C*u,t[3]=v*a+p*h+b*P+C*d,v=i[4],p=i[5],b=i[6],C=i[7],t[4]=v*r+p*o+b*g+C*m,t[5]=v*n+p*l+b*x+C*y,t[6]=v*s+p*f+b*c+C*u,t[7]=v*a+p*h+b*P+C*d,v=i[8],p=i[9],b=i[10],C=i[11],t[8]=v*r+p*o+b*g+C*m,t[9]=v*n+p*l+b*x+C*y,t[10]=v*s+p*f+b*c+C*u,t[11]=v*a+p*h+b*P+C*d,v=i[12],p=i[13],b=i[14],C=i[15],t[12]=v*r+p*o+b*g+C*m,t[13]=v*n+p*l+b*x+C*y,t[14]=v*s+p*f+b*c+C*u,t[15]=v*a+p*h+b*P+C*d,t}function L(t,e,i){var r=Math.sin(i),n=Math.cos(i),s=e[4],a=e[5],o=e[6],l=e[7],f=e[8],h=e[9],g=e[10],x=e[11];return e!==t&&(t[0]=e[0],t[1]=e[1],t[2]=e[2],t[3]=e[3],t[12]=e[12],t[13]=e[13],t[14]=e[14],t[15]=e[15]),t[4]=s*n+f*r,t[5]=a*n+h*r,t[6]=o*n+g*r,t[7]=l*n+x*r,t[8]=f*n-s*r,t[9]=h*n-a*r,t[10]=g*n-o*r,t[11]=x*n-l*r,t}function k(t,e,i){var r=Math.sin(i),n=Math.cos(i),s=e[0],a=e[1],o=e[2],l=e[3],f=e[8],h=e[9],g=e[10],x=e[11];return e!==t&&(t[4]=e[4],t[5]=e[5],t[6]=e[6],t[7]=e[7],t[12]=e[12],t[13]=e[13],t[14]=e[14],t[15]=e[15]),t[0]=s*n-f*r,t[1]=a*n-h*r,t[2]=o*n-g*r,t[3]=l*n-x*r,t[8]=s*r+f*n,t[9]=a*r+h*n,t[10]=o*r+g*n,t[11]=l*r+x*n,t}function rt(t,e,i){var r=Math.sin(i),n=Math.cos(i),s=e[0],a=e[1],o=e[2],l=e[3],f=e[4],h=e[5],g=e[6],x=e[7];return e!==t&&(t[8]=e[8],t[9]=e[9],t[10]=e[10],t[11]=e[11],t[12]=e[12],t[13]=e[13],t[14]=e[14],t[15]=e[15]),t[0]=s*n+f*r,t[1]=a*n+h*r,t[2]=o*n+g*r,t[3]=l*n+x*r,t[4]=f*n-s*r,t[5]=h*n-a*r,t[6]=g*n-o*r,t[7]=x*n-l*r,t}function nt(t,e,i,r,n){var s=1/Math.tan(e/2);if(t[0]=s/i,t[1]=0,t[2]=0,t[3]=0,t[4]=0,t[5]=s,t[6]=0,t[7]=0,t[8]=0,t[9]=0,t[11]=-1,t[12]=0,t[13]=0,t[15]=0,n!=null&&n!==1/0){var a=1/(r-n);t[10]=(n+r)*a,t[14]=2*n*r*a}else t[10]=-1,t[14]=-2*r;return t}var X=nt;function H(t,e,i,r){var n,s,a,o,l,f,h,g,x,c,P=e[0],m=e[1],y=e[2],u=r[0],d=r[1],v=r[2],p=i[0],b=i[1],C=i[2];return Math.abs(P-p)<U&&Math.abs(m-b)<U&&Math.abs(y-C)<U?tt(t):(h=P-p,g=m-b,x=y-C,c=1/Math.sqrt(h*h+g*g+x*x),h*=c,g*=c,x*=c,n=d*x-v*g,s=v*h-u*x,a=u*g-d*h,c=Math.sqrt(n*n+s*s+a*a),c?(c=1/c,n*=c,s*=c,a*=c):(n=0,s=0,a=0),o=g*a-x*s,l=x*n-h*a,f=h*s-g*n,c=Math.sqrt(o*o+l*l+f*f),c?(c=1/c,o*=c,l*=c,f*=c):(o=0,l=0,f=0),t[0]=n,t[1]=o,t[2]=h,t[3]=0,t[4]=s,t[5]=l,t[6]=g,t[7]=0,t[8]=a,t[9]=f,t[10]=x,t[11]=0,t[12]=-(n*P+s*m+a*y),t[13]=-(o*P+l*m+f*y),t[14]=-(h*P+g*m+x*y),t[15]=1,t)}var it=et;function _(){var t=new R(3);return R!=Float32Array&&(t[0]=0,t[1]=0,t[2]=0),t}function st(t){var e=t[0],i=t[1],r=t[2];return Math.sqrt(e*e+i*i+r*r)}function B(t,e,i){var r=new R(3);return r[0]=t,r[1]=e,r[2]=i,r}function z(t,e){var i=e[0],r=e[1],n=e[2],s=i*i+r*r+n*n;return s>0&&(s=1/Math.sqrt(s)),t[0]=e[0]*s,t[1]=e[1]*s,t[2]=e[2]*s,t}function Y(t,e){return t[0]*e[0]+t[1]*e[1]+t[2]*e[2]}function T(t,e,i){var r=e[0],n=e[1],s=e[2],a=i[0],o=i[1],l=i[2];return t[0]=n*l-s*o,t[1]=s*a-r*l,t[2]=r*o-n*a,t}function at(t,e){e=e===void 0?1:e;var i=G()*2*Math.PI,r=G()*2-1,n=Math.sqrt(1-r*r)*e;return t[0]=Math.cos(i)*n,t[1]=Math.sin(i)*n,t[2]=r*e,t}function ot(t,e,i){var r=e[0],n=e[1],s=e[2],a=i[3]*r+i[7]*n+i[11]*s+i[15];return a=a||1,t[0]=(i[0]*r+i[4]*n+i[8]*s+i[12])/a,t[1]=(i[1]*r+i[5]*n+i[9]*s+i[13])/a,t[2]=(i[2]*r+i[6]*n+i[10]*s+i[14])/a,t}function lt(t,e,i){var r=i[0],n=i[1],s=i[2],a=i[3],o=e[0],l=e[1],f=e[2],h=n*f-s*l,g=s*o-r*f,x=r*l-n*o;return h=h+h,g=g+g,x=x+x,t[0]=o+a*h+n*x-s*g,t[1]=l+a*g+s*h-r*x,t[2]=f+a*x+r*g-n*h,t}var ht=st;(function(){var t=_();return function(e,i,r,n,s,a){var o,l;for(i||(i=3),r||(r=0),n?l=Math.min(n*i+r,e.length):l=e.length,o=r;o<l;o+=i)t[0]=e[o],t[1]=e[o+1],t[2]=e[o+2],s(t,t,a),e[o]=t[0],e[o+1]=t[1],e[o+2]=t[2];return e}})();function ft(){var t=new R(4);return R!=Float32Array&&(t[0]=0,t[1]=0,t[2]=0,t[3]=0),t}function gt(t,e){var i=e[0],r=e[1],n=e[2],s=e[3],a=i*i+r*r+n*n+s*s;return a>0&&(a=1/Math.sqrt(a)),t[0]=i*a,t[1]=r*a,t[2]=n*a,t[3]=s*a,t}(function(){var t=ft();return function(e,i,r,n,s,a){var o,l;for(i||(i=4),r||(r=0),n?l=Math.min(n*i+r,e.length):l=e.length,o=r;o<l;o+=i)t[0]=e[o],t[1]=e[o+1],t[2]=e[o+2],t[3]=e[o+3],s(t,t,a),e[o]=t[0],e[o+1]=t[1],e[o+2]=t[2],e[o+3]=t[3];return e}})();function D(){var t=new R(4);return R!=Float32Array&&(t[0]=0,t[1]=0,t[2]=0),t[3]=1,t}function $(t,e,i){i=i*.5;var r=Math.sin(i);return t[0]=r*e[0],t[1]=r*e[1],t[2]=r*e[2],t[3]=Math.cos(i),t}function N(t,e,i,r){var n=e[0],s=e[1],a=e[2],o=e[3],l=i[0],f=i[1],h=i[2],g=i[3],x,c,P,m,y;return c=n*l+s*f+a*h+o*g,c<0&&(c=-c,l=-l,f=-f,h=-h,g=-g),1-c>U?(x=Math.acos(c),P=Math.sin(x),m=Math.sin((1-r)*x)/P,y=Math.sin(r*x)/P):(m=1-r,y=r),t[0]=m*n+y*l,t[1]=m*s+y*f,t[2]=m*a+y*h,t[3]=m*o+y*g,t}function xt(t,e){var i=e[0]+e[4]+e[8],r;if(i>0)r=Math.sqrt(i+1),t[3]=.5*r,r=.5/r,t[0]=(e[5]-e[7])*r,t[1]=(e[6]-e[2])*r,t[2]=(e[1]-e[3])*r;else{var n=0;e[4]>e[0]&&(n=1),e[8]>e[n*3+n]&&(n=2);var s=(n+1)%3,a=(n+2)%3;r=Math.sqrt(e[n*3+n]-e[s*3+s]-e[a*3+a]+1),t[n]=.5*r,r=.5/r,t[3]=(e[s*3+a]-e[a*3+s])*r,t[s]=(e[s*3+n]+e[n*3+s])*r,t[a]=(e[a*3+n]+e[n*3+a])*r}return t}var W=gt;(function(){var t=_(),e=B(1,0,0),i=B(0,1,0);return function(r,n,s){var a=Y(n,s);return a<-.999999?(T(t,e,n),ht(t)<1e-6&&T(t,i,n),z(t,t),$(r,t,Math.PI),r):a>.999999?(r[0]=0,r[1]=0,r[2]=0,r[3]=1,r):(T(t,n,s),r[0]=t[0],r[1]=t[1],r[2]=t[2],r[3]=1+a,W(r,r))}})();(function(){var t=D(),e=D();return function(i,r,n,s,a,o){return N(t,r,a,o),N(e,n,s,o),N(i,t,e,2*o*(1-o)),i}})();(function(){var t=J();return function(e,i,r,n){return t[0]=r[0],t[3]=r[1],t[6]=r[2],t[1]=n[0],t[4]=n[1],t[7]=n[2],t[2]=-i[0],t[5]=-i[1],t[8]=-i[2],W(e,xt(e,t))}})();class E{glContext;source;program;attributes;uniforms;constructor(e,i){this.glContext=e,this.source=i,this.source=this.source.split("__split__"),this.program=this.compileProgram(this.source[0],this.source[1]),this.attributes=this.gatherAttribs(),this.uniforms=this.gatherUniforms()}use(){this.glContext.useProgram(this.program)}compileProgram(e,i){let r=this.compileShader(e,this.glContext.VERTEX_SHADER),n=this.compileShader(i,this.glContext.FRAGMENT_SHADER),s=this.glContext.createProgram();if(this.glContext.attachShader(s,r),this.glContext.attachShader(s,n),this.glContext.linkProgram(s),!this.glContext.getProgramParameter(s,this.glContext.LINK_STATUS))throw console.error(this.glContext.getProgramInfoLog(s)),new Error("Failed to compile program.");return s}compileShader(e,i){let r=this.glContext.createShader(i);if(this.glContext.shaderSource(r,e),this.glContext.compileShader(r),!this.glContext.getShaderParameter(r,this.glContext.COMPILE_STATUS)){let n=this.glContext.getShaderInfoLog(r),s=parseInt(n.split(":")[2]),a=e.split(`
`);for(let l in a){let f=parseInt(l);console.error(f+"  "+a[l]),parseInt(l)===s-1&&console.error(n)}let o=i===this.glContext.VERTEX_SHADER?"vertex":"fragment";throw Error("Failed to compile "+o+" shader.")}return r}setUniform(e,i,r){let n=Array.prototype.slice.call(arguments,2),s;this.use();try{s=this.uniforms[e].location}catch(a){throw console.error(e),a}this.glContext["uniform"+i].apply(this.glContext,[s].concat(n))}gatherUniforms(){let e={},i=this.glContext.getProgramParameter(this.program,this.glContext.ACTIVE_UNIFORMS);for(let r=0;r<i;r++){let n=this.glContext.getActiveUniform(this.program,r);e[n.name]={name:n.name,location:this.glContext.getUniformLocation(this.program,n.name),type:n.type,size:n.size}}return e}gatherAttribs(){let e={},i=this.glContext.getProgramParameter(this.program,this.glContext.ACTIVE_ATTRIBUTES);for(let r=0;r<i;r++){let n=this.glContext.getActiveAttrib(this.program,r);e[n.name]={name:n.name,location:this.glContext.getAttribLocation(this.program,n.name),type:n.type,size:n.size}}return e}}class ct{glContext;buffer;constructor(e){this.glContext=e,this.buffer=this.glContext.createBuffer()}bind(){this.glContext.bindBuffer(this.glContext.ARRAY_BUFFER,this.buffer)}set(e){this.bind(),this.glContext.bufferData(this.glContext.ARRAY_BUFFER,e,this.glContext.STATIC_DRAW)}}class j{glContext;program;buffers;primitiveCount;constructor(e,i,r,n){this.glContext=e,this.program=i,this.buffers=r,this.primitiveCount=n}render(){this.program.use();for(let e in this.buffers){let i=this.buffers[e].buffer,r=this.buffers[e].size,n;try{n=this.program.attributes[e].location}catch(s){throw console.error("Could not find location for",e),s}i.bind(),this.glContext.enableVertexAttribArray(n),this.glContext.vertexAttribPointer(n,r,this.glContext.FLOAT,!1,0,0)}this.glContext.drawArrays(this.glContext.TRIANGLES,0,3*this.primitiveCount);for(let e in this.buffers)this.glContext.disableVertexAttribArray(this.program.attributes[e].location)}}function V(t,e){let i={};for(let r in e)i[r]={buffer:new ct(t),size:e[r]};return i}function dt(t,e){let i=[-1,-1,-1,1,-1,-1,1,1,-1,-1,-1,-1,1,1,-1,-1,1,-1],r=[0,0,1,0,1,1,0,0,1,1,0,1],n=V(t,{aPosition:3,aUV:2});n.aPosition.buffer.set(new Float32Array(i)),n.aUV.buffer.set(new Float32Array(r));let s=i.length/9;return new j(t,e,n,s)}function ut(t,e,i,r){let n=Math.pow(r.random(),4),s=[n,n,n,n,n,n,n,n,n,n,n,n,n,n,n,n,n,n],a=[[-t,-t,0],[t,-t,0],[t,t,0],[-t,-t,0],[t,t,0],[-t,t,0]],o=[];for(let l=0;l<6;l++){let f=vt(e);lt(a[l],a[l],f),a[l][0]+=e[0]*i,a[l][1]+=e[1]*i,a[l][2]+=e[2]*i,o.push.apply(o,a[l])}return{position:o,color:s}}function F(t,e){let i=[-1,-1,-1,1,-1,-1,1,1,-1,-1,-1,-1,1,1,-1,-1,1,-1,1,-1,1,-1,-1,1,-1,1,1,1,-1,1,-1,1,1,1,1,1,1,-1,-1,1,-1,1,1,1,1,1,-1,-1,1,1,1,1,1,-1,-1,-1,1,-1,-1,-1,-1,1,-1,-1,-1,1,-1,1,-1,-1,1,1,-1,1,-1,1,1,-1,1,1,1,-1,1,-1,1,1,1,-1,1,1,-1,-1,1,1,-1,1,1,-1,-1,-1,-1,1,1,-1,-1,-1,-1,-1],r=V(t,{aPosition:3});r.aPosition.buffer.set(new Float32Array(i));let n=i.length/9;return new j(t,e,r,n)}function mt(t,e){let i=Math.acos(Y(t,e)),r=_();T(r,t,e),z(r,r);let n=D();return $(n,r,i),n}function vt(t){return mt(B(0,0,-1),t)}function K(t){let e=M();return L(e,e,t.random()*Math.PI*2),k(e,e,t.random()*Math.PI*2),rt(e,e,t.random()*Math.PI*2),e}function O(t){let e=[0,0,1],i=K(t);return ot(e,e,i),z(e,e),e}function S(t){let e=0;for(let i=0;i<t.length;i++){let r=t.charCodeAt(i);e+=(i+1)*r}return e}class pt{glContext;index;data;width;height;options;texture;constructor(e,i,r,n,s,a){this.glContext=e,this.index=i,this.data=r,this.width=n,this.height=s,this.options=a||{},this.options.target=a.target||this.glContext.TEXTURE_2D,this.options.mag=a.mag||this.glContext.NEAREST,this.options.min=a.min||this.glContext.NEAREST,this.options.wraps=a.wraps||this.glContext.CLAMP_TO_EDGE,this.options.wrapt=a.wrapt||this.glContext.CLAMP_TO_EDGE,this.options.internalFormat=a.internalFormat||this.glContext.RGBA,this.options.format=a.format||this.glContext.RGBA,this.options.type=a.type||this.glContext.UNSIGNED_BYTE,this.activate(),this.texture=this.glContext.createTexture(),this.bind(),this.glContext.texImage2D(this.options.target,0,this.options.internalFormat,this.options.format,this.options.type,r),this.glContext.texParameteri(this.options.target,this.glContext.TEXTURE_MAG_FILTER,this.options.mag),this.glContext.texParameteri(this.options.target,this.glContext.TEXTURE_MIN_FILTER,this.options.min),this.glContext.texParameteri(this.options.target,this.glContext.TEXTURE_WRAP_S,this.options.wraps),this.glContext.texParameteri(this.options.target,this.glContext.TEXTURE_WRAP_T,this.options.wrapt),(this.options.mag!==this.glContext.NEAREST||this.options.min!==this.glContext.NEAREST)&&this.glContext.generateMipmap(this.options.target)}activate(){this.glContext.activeTexture(this.glContext.TEXTURE0+this.index)}bind(){this.glContext.bindTexture(this.options.target,this.texture)}reset(){this.activate(),this.bind(),this.glContext=this.glContext.texImage2D(this.options.target,0,this.options.internalFormat,this.width,this.height,0,this.options.format,this.options.type,this.data)}}class bt{glContext;renderCanvas;skyboxProgram;skybox;textures;constructor(e,i){this.renderCanvas=i,this.glContext=this.renderCanvas.getContext("webgl"),this.glContext.pixelStorei(this.glContext.UNPACK_FLIP_Y_WEBGL,!0),e=e.toString("utf-8"),this.skyboxProgram=new E(this.glContext,e),this.skybox=dt(this.glContext,this.skyboxProgram),this.textures={}}setTextures(e){this.textures={};let i=Object.keys(e);for(let r=0;r<i.length;r++){let n=e[i[r]];this.textures[i[r]]=new pt(this.glContext,0,n,n.width,n.height,{min:this.glContext.LINEAR_MIPMAP_LINEAR,mag:this.glContext.LINEAR})}}render(e,i){this.glContext.viewport(0,0,this.renderCanvas.width,this.renderCanvas.height);let r=M();this.skyboxProgram.use(),this.skyboxProgram.setUniform("uView","Matrix4fv",!1,e),this.skyboxProgram.setUniform("uProjection","Matrix4fv",!1,i),this.textures.front.bind(),this.skyboxProgram.setUniform("uModel","Matrix4fv",!1,r),this.skybox.render(),this.textures.back.bind(),k(r,M(),Math.PI),this.skyboxProgram.setUniform("uModel","Matrix4fv",!1,r),this.skybox.render(),this.textures.left.bind(),k(r,M(),Math.PI/2),this.skyboxProgram.setUniform("uModel","Matrix4fv",!1,r),this.skybox.render(),this.textures.right.bind(),k(r,M(),-Math.PI/2),this.skyboxProgram.setUniform("uModel","Matrix4fv",!1,r),this.skybox.render(),this.textures.top.bind(),L(r,M(),Math.PI/2),this.skyboxProgram.setUniform("uModel","Matrix4fv",!1,r),this.skybox.render(),this.textures.bottom.bind(),L(r,M(),-Math.PI/2),this.skyboxProgram.setUniform("uModel","Matrix4fv",!1,r),this.skybox.render()}}var I={},q;function Ct(){if(q)return I;q=1,Object.defineProperty(I,"__esModule",{value:!0});function t(i){return i!=null}var e=(function(){function i(r){r===void 0&&(r=Math.random()*4294967295|0),this._seed=r,this._index=0,this._state=new Array(624),this._state[0]=r;for(var n=this._state,s=1;s<624;s++)n[s]=n[s-1]^n[s-1]>>>30,n[s]=1812433253*n[s]+s,n[s]=n[s]&(n[s]<<32)-1}return i.prototype.generateNumbers=function(){for(var r,n=this._state,s=0;s<624;s++)r=n[s]&2147483648,r=r+(n[(s+1)%624]&2147483647),n[s]=n[(s+397)%624]^r>>>1,r%2!==0&&(n[s]=n[s]^2567483615)},i.prototype.uniform=function(){this._index===0&&this.generateNumbers();var r=this._state[this._index];return r=r^r>>>11,r=r^r<<7&2636928640,r=r^r<<15&4022730752,r=r^r>>>18,this._index=(this._index+1)%624,(r>>>0)*(1/4294967296)},i.prototype.random=function(){return this.uniform()},i.prototype.range=function(r,n){if(t(r))t(n)||(n=r,r=0);else return this.uniform();return r+Math.floor(this.uniform()*(n-r))},i})();return I.RNG=e,I}var A=Ct();class yt{starCount;canvas;glContext;nebulaProgram;nebulaRenderable;pointStarsProgram;pointStarsRenderable;starProgram;starRenderable;sunProgram;sunRenderable;constructor(e,i,r,n){this.starCount=1e5,this.canvas=document.createElement("canvas"),this.glContext=this.canvas.getContext("webgl"),this.glContext.enable(this.glContext.BLEND),this.glContext.blendFuncSeparate(this.glContext.SRC_ALPHA,this.glContext.ONE_MINUS_SRC_ALPHA,this.glContext.ZERO,this.glContext.ONE),e=e.toString("utf-8"),i=i.toString("utf-8"),r=r.toString("utf-8"),n=n.toString("utf-8"),this.nebulaProgram=new E(this.glContext,e),this.pointStarsProgram=new E(this.glContext,i),this.starProgram=new E(this.glContext,r),this.sunProgram=new E(this.glContext,n);let s=new A.RNG(S("best seed ever")+5e3),a=new Float32Array(18*this.starCount),o=new Float32Array(18*this.starCount);for(let h=0;h<this.starCount;h++){let g=.05,x=at(_(),1);r=ut(g,x,128,s),a.set(r.position,h*18),o.set(r.color,h*18)}let l=V(this.glContext,{aPosition:3,aColor:3});l.aPosition.buffer.set(a),l.aColor.buffer.set(o);let f=a.length/9;this.pointStarsRenderable=new j(this.glContext,this.pointStarsProgram,l,f),this.nebulaRenderable=F(this.glContext,this.nebulaProgram),this.sunRenderable=F(this.glContext,this.sunProgram),this.starRenderable=F(this.glContext,this.starProgram)}render(e){let i={};this.canvas.width=this.canvas.height=e.resolution,this.glContext.viewport(0,0,e.resolution,e.resolution);let r=new A.RNG(S(e.seed)+1e3),n=[];for(;e.pointStars&&(n.push({rotation:K(r)}),!(r.random()<.2)););r=new A.RNG(S(e.seed)+3e3);let s=[];for(;e.stars&&(s.push({pos:O(r),color:[1,1,1],size:0,falloff:r.random()*Math.pow(2,20)+Math.pow(2,20)}),!(r.random()<.01)););r=new A.RNG(S(e.seed)+2e3);let a=[];for(;e.nebulae&&(a.push({scale:r.random()*.5+.25,color:[r.random(),r.random(),r.random()],intensity:r.random()*.2+.9,falloff:r.random()*3+3,offset:[r.random()*2e3-1e3,r.random()*2e3-1e3,r.random()*2e3-1e3]}),!(r.random()<.5)););r=new A.RNG(S(e.seed)+4e3);let o=[];e.sun&&o.push({pos:O(r),color:[r.random(),r.random(),r.random()],size:r.random()*1e-4+1e-4,falloff:r.random()*16+8});let l={front:{target:[0,0,-1],up:[0,1,0]},back:{target:[0,0,1],up:[0,1,0]},left:{target:[-1,0,0],up:[0,1,0]},right:{target:[1,0,0],up:[0,1,0]},top:{target:[0,1,0],up:[0,0,1]},bottom:{target:[0,-1,0],up:[0,0,-1]}},f=M(),h=M(),g=M();X(g,Math.PI/2,1,.1,256);let x=Object.keys(l);for(let c=0;c<x.length;c++){this.glContext.clearColor(0,0,0,1),this.glContext.clear(this.glContext.COLOR_BUFFER_BIT);let P=l[x[c]];H(h,[0,0,0],P.target,P.up),this.pointStarsProgram.use(),f=M(),this.pointStarsProgram.setUniform("uView","Matrix4fv",!1,h),this.pointStarsProgram.setUniform("uProjection","Matrix4fv",!1,g);for(let u=0;u<n.length;u++){let d=n[u];it(f,d.rotation,f),this.pointStarsProgram.setUniform("uModel","Matrix4fv",!1,f),this.pointStarsRenderable.render()}this.starProgram.use(),this.starProgram.setUniform("uView","Matrix4fv",!1,h),this.starProgram.setUniform("uProjection","Matrix4fv",!1,g),this.starProgram.setUniform("uModel","Matrix4fv",!1,f);for(let u=0;u<s.length;u++){let d=s[u];this.starProgram.setUniform("uPosition","3fv",d.pos),this.starProgram.setUniform("uColor","3fv",d.color),this.starProgram.setUniform("uSize","1f",d.size),this.starProgram.setUniform("uFalloff","1f",d.falloff),this.starRenderable.render()}this.nebulaProgram.use(),f=M();for(let u=0;u<a.length;u++){let d=a[u];this.nebulaProgram.setUniform("uModel","Matrix4fv",!1,f),this.nebulaProgram.setUniform("uView","Matrix4fv",!1,h),this.nebulaProgram.setUniform("uProjection","Matrix4fv",!1,g),this.nebulaProgram.setUniform("uScale","1f",d.scale),this.nebulaProgram.setUniform("uColor","3fv",d.color),this.nebulaProgram.setUniform("uIntensity","1f",d.intensity),this.nebulaProgram.setUniform("uFalloff","1f",d.falloff),this.nebulaProgram.setUniform("uOffset","3fv",d.offset),this.nebulaRenderable.render()}this.sunProgram.use(),this.sunProgram.setUniform("uView","Matrix4fv",!1,h),this.sunProgram.setUniform("uProjection","Matrix4fv",!1,g),this.sunProgram.setUniform("uModel","Matrix4fv",!1,f);for(let u=0;u<o.length;u++){let d=o[u];this.sunProgram.setUniform("uPosition","3fv",d.pos),this.sunProgram.setUniform("uColor","3fv",d.color),this.sunProgram.setUniform("uSize","1f",d.size),this.sunProgram.setUniform("uFalloff","1f",d.falloff),this.sunRenderable.render()}let m=document.createElement("canvas");m.width=m.height=e.resolution;let y=m.getContext("2d");y&&y.drawImage(this.canvas,0,0),i[x[c]]=m}return i}}function Mt({}){return[{title:"Vinyl"},{name:"description",content:"Vinyl"}]}class Pt extends Z.Component{fov;pointStars;seed;stars;sun;nebulae;resolution;animationSpeed;unifiedTexture;renderCanvas;tick;skybox;space;constructor(e){super(e),this.fov=60,this.fov=this.fov/360*Math.PI*2,this.pointStars=!0,this.seed=(Math.random()*1e18).toString(36),this.stars=!0,this.sun=!0,this.nebulae=!0,this.resolution=1024,this.animationSpeed=.015,this.unifiedTexture=!0,this.tick=0,this.renderSpace=this.renderSpace.bind(this),this.state={pageData:{}}}componentDidMount(){this.renderCanvas=document.getElementById("render-canvas"),this.renderCanvas.width=window.innerWidth,this.renderCanvas.height=window.innerHeight;let e=async()=>{let r=await(await fetch("glsl/nebula.glsl")).text(),s=await(await fetch("glsl/point-stars.glsl")).text(),o=await(await fetch("glsl/skybox.glsl")).text(),f=await(await fetch("glsl/star.glsl")).text(),g=await(await fetch("glsl/sun.glsl")).text();this.skybox=new bt(o,this.renderCanvas),this.space=new yt(r,s,f,g),this.renderTextures(),this.renderSpace()};fetch("pageData.json").then(i=>i.text()).then(i=>{this.setState({pageData:JSON.parse(i)})}),e()}hideUnified(){let e=document.getElementById("texture-canvas");e&&(e.style.display="none")}hideSplit(){let e=document.getElementById("texture-left");e&&(e.style.display="none");let i=document.getElementById("texture-right");i&&(i.style.display="none");let r=document.getElementById("texture-top");r&&(r.style.display="none");let n=document.getElementById("texture-bottom");n&&(n.style.display="none");let s=document.getElementById("texture-front");s&&(s.style.display="none");let a=document.getElementById("texture-back");a&&(a.style.display="none")}renderTextures(){let e=(n,s)=>{let a=document.getElementById(s);if(a){a.width=a.height=this.resolution;let o=a.getContext("2d");o&&o.drawImage(n,0,0)}},i=this.space.render({seed:this.seed,pointStars:this.pointStars,stars:this.stars,sun:this.sun,nebulae:this.nebulae,unifiedTexture:this.unifiedTexture,resolution:this.resolution});this.skybox.setTextures(i);let r=document.getElementById("texture-canvas");if(r){r.width=4*this.resolution,r.height=3*this.resolution;let n=r.getContext("2d");n&&(n.drawImage(i.left,this.resolution*0,this.resolution*1),n.drawImage(i.right,this.resolution*2,this.resolution*1),n.drawImage(i.front,this.resolution*1,this.resolution*1),n.drawImage(i.back,this.resolution*3,this.resolution*1),n.drawImage(i.top,this.resolution*1,this.resolution*0),n.drawImage(i.bottom,this.resolution*1,this.resolution*2))}e(i.left,"texture-left"),e(i.right,"texture-right"),e(i.front,"texture-front"),e(i.back,"texture-back"),e(i.top,"texture-top"),e(i.bottom,"texture-bottom")}renderSpace(){this.hideUnified(),this.hideSplit(),this.tick+=.0025*this.animationSpeed;let e=M(),i=M();this.renderCanvas.width=window.innerWidth,this.renderCanvas.height=window.innerHeight,H(e,[0,0,0],[Math.cos(this.tick),Math.sin(this.tick*.555),Math.sin(this.tick)],[0,1,0]),X(i,this.fov,this.renderCanvas.width/this.renderCanvas.height,.1,8),this.skybox.render(e,i),requestAnimationFrame(this.renderSpace)}getLinks(){let e=[];for(let i in this.state.pageData.socialLinks)e.push(w.jsx("a",{className:"button",href:this.state.pageData.socialLinks[i].url,target:"_blank",rel:"noopener noreferrer",children:w.jsx("img",{src:"assets/"+this.state.pageData.socialLinks[i].logo,alt:this.state.pageData.socialLinks[i].name})},this.state.pageData.socialLinks[i].name));return e}render(){return w.jsxs("div",{id:"App",children:[w.jsxs("div",{id:"information",children:[w.jsx("p",{children:this.state.pageData.pageTitle}),w.jsx("div",{id:"links",children:this.getLinks()})]}),w.jsx("canvas",{id:"render-canvas"}),w.jsx("canvas",{id:"texture-canvas"}),w.jsx("canvas",{id:"texture-left",className:"texture"}),w.jsx("canvas",{id:"texture-right",className:"texture"}),w.jsx("canvas",{id:"texture-top",className:"texture"}),w.jsx("canvas",{id:"texture-bottom",className:"texture"}),w.jsx("canvas",{id:"texture-front",className:"texture"}),w.jsx("canvas",{id:"texture-back",className:"texture"})]})}}const Rt=Q(function(){return w.jsx(Pt,{})});export{Rt as default,Mt as meta};
